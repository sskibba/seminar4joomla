<?php//*******************************************//***         Seminar for joomla!         ***//***            Version 1.3.0            ***//*******************************************//***     Copyright (c) Dirk Vollmar      ***//***             2004 / 2009             ***//***          joomla@vollmar.ws          ***//***         All rights reserved         ***//*******************************************//*     Released under GNU/GPL License      *//*  http://www.gnu.org/licenses/gpl.html   *//*******************************************defined('_JEXEC') or die('Restricted access');class HTML_FrontSeminar {// ++++++++++++++++++++++++++++++++++++// +++ Anzeige der Kursuebersichten +++// ++++++++++++++++++++++++++++++++++++// listen = datelist,dateid,clist,catid  function sem_g001($art,$rows,$pageNav,$search,$limit,$limitstart,$total,$datelist,$dateid,$clist,$catid) {    $document = &JFactory::getDocument();    $document->addCustomTag(sem_f027(0));    $database = &JFactory::getDBO();    $my = &JFactory::getuser();    $config = &JComponentHelper::getParams('com_seminar');    $neudatum = sem_f046();    JHTML::_('behavior.modal');// ---------------------------------// Anzeige Kopfbereich mit Auswahl// ---------------------------------    echo sem_f026(1);    $knopfoben = "";    $knopfunten = sem_f032(($art+1));    if($art==2) {      $knopfoben .= JHTML::_('link',"javascript:auf(8,'','')",JHTML::_('image',sem_f006().'1832.png',null,array('border'=>'0','align'=>'absmiddle')),array('title'=>JTEXT::_('SEM_0060')));      $knopfunten .= " <button class=\"button\" style=\"cursor:pointer;\" type=\"button\" onclick=\"auf(8,'','');\">".JHTML::_('image',sem_f006().'1816.png',null,array('border'=>'0','align'=>'absmiddle'))."&nbsp;".JTEXT::_('SEM_0060')."</button>";    }    if(count($rows)>0) {      if($art==0 AND $config->get('sem_p048',0)==1) {        $href = JURI::ROOT()."index2.php?option=".JRequest::getCmd('option')."&task=31";        $knopfoben .= "<a href=\"".$href."\" target=\"_new\" title=\"".JTEXT::_('SEM_1048')."\" border=\"0\">".JHTML::_('image',sem_f006().'3132.png',null,array('border'=>'0','align'=>'absmiddle'))."</a>";        $knopfunten .= " <button class=\"button\" style=\"cursor:pointer;\" type=\"button\" onClick=\"window.open('".$href."');\"><img src=\"".sem_f006()."3116.png\" border=\"0\" align=\"absmiddle\">&nbsp;".JTEXT::_('SEM_1048')."</button>";      }      $knopfoben .= sem_f037(($art+2),'','','');      $knopfunten .= "&nbsp;".sem_f037(($art+2),'','','b');    }    if($config->get('sem_p024',2)==0 OR $config->get('sem_p024',2)==2) {      echo $knopfoben;    }    sem_f033();    $html = "";// ---------------------// Anzeige Kategoriekopf// ---------------------    $navioben1 = array();    if($art==0) {      if($catid==0) {        $headline = array(JTEXT::_('SEM_0027'),JTEXT::_('SEM_1001'));      } else {        $headline = sem_f012($catid);      }      $navioben1 = explode(" ",$config->get('sem_p053','SEM_NUMBER SEM_SEARCH SEM_CATEGORIES SEM_RESET'));    } elseif($art==1) {      $headline = array(JTEXT::_('SEM_1005'),JTEXT::_('SEM_1006'));      $navioben1 = explode(" ",$config->get('sem_p054','SEM_NUMBER SEM_SEARCH SEM_TYPES SEM_RESET'));    } elseif($art==2) {      $headline = array(JTEXT::_('SEM_1031'),JTEXT::_('SEM_1032'));      $navioben1 = explode(" ",$config->get('sem_p055','SEM_NUMBER SEM_SEARCH SEM_TYPES SEM_RESET'));    }    sem_f041($headline[0],$headline[1]);// ------------------------------------------------// Ausgabe der oberen Seitennavigation// ------------------------------------------------    $navioben2 = array('SEM_NUMBER','SEM_SEARCH','SEM_CATEGORIES','SEM_TYPES','SEM_RESET');    $navioben3 = array_diff($navioben2,$navioben1);    if(count($navioben1)>0 OR $navioben1[0]!="NULL") {      $html .= sem_f023(4)."<tr>";      foreach($navioben1 AS $el) {        switch($el) {          case "SEM_NUMBER":            $html .= sem_f022(JTEXT::_('SEM_0050')."&nbsp;".sem_f040(1,$limit),'d','l','','sem_nav');            break;          case "SEM_SEARCH":            $html .= sem_f022(JTEXT::_('SEM_0067').": <input class=\"sem_inputbox\" type=\"text\" name=\"search\" height=\"16\" size=\"15\" value=\"".$search."\" onChange=\"document.FrontForm.submit();\"/>",'d','c','','sem_nav');            break;          case "SEM_CATEGORIES":            $html .= sem_f022(JTEXT::_('SEM_0008').": ".$clist,'d','c','','sem_nav');            break;          case "SEM_TYPES":            $html .= sem_f022(JTEXT::_('SEM_1039').": ".$datelist,'d','c','','sem_nav');            break;          case "SEM_RESET":            $html .= sem_f022("<button class=\"button\" style=\"cursor:pointer;\" type=\"button\" onclick=\"document.FrontForm.dateid.value=1;document.FrontForm.catid.value=0;document.FrontForm.search.value='';document.FrontForm.limit.value=".$config->get('sem_p021','').";document.FrontForm.submit();\">".JTEXT::_('SEM_1036')."</button>",'d','r','','sem_nav');            break;        }      }      $html .= "</tr>".sem_f023('e');    }    $n = count($rows);    if($n<$total) {      $html .= $pageNav;    }// ---------------------------// Anzeige der einzelnen Kurse// ---------------------------    $html .= sem_f023(4);    if($n>0) {    // Schleife beginnen      for ($i=0, $n; $i < $n; $i++) {        $row = &$rows[$i];// Pruefung, ob Lehrgang buchbar        $buchopt = sem_f021($art, $row, $my->id);// Bild ausgeben        $html .= "<tr>";        $zusimage = "";        $zusbild = 0;        if($art==0) {          $linksbild = sem_f006()."2601.png";          if($my->id == $row->publisher) {            $linksbild = sem_f006()."2603.png";            $zusimage = sem_f006()."2607.png";          }          if($buchopt[0] == 2) {            $linksbild = sem_f006()."2602.png";            $zusimage = sem_f006()."2606.png";          }          $funktion = array(JTEXT::_('SEM_0014'),3);        } elseif($art==1) {          $linksbild = sem_f006()."2701.png";          $funktion = array(JTEXT::_('SEM_0014'),4);          $zusimage = sem_f006()."2606.png";        } elseif($art==2) {          $linksbild = sem_f006()."2801.png";          $funktion = array(JTEXT::_('SEM_0051'),9);          if($row->publisher==$my->id) {            $zusimage = sem_f006()."2607.png";          }        }        if($my->id==0) {          $zusimage = "";        }        if($row->cancelled==1) {          $linksbild = sem_f006()."2604.png";          $zusimage = sem_f006()."2200.png";        }        if($row->catimage!="") {          $linksbild = sem_f007(0).$row->catimage;          $zusbild = 1;        }        if($row->image!="" AND $config->get('sem_p032','')==1) {          $linksbild = sem_f007(1).$row->image;          $zusbild = 1;        }        $htxt = "<div style=\"position:relative;top:0px;left:0px;\"><a title=\"".$funktion[0]."\" href=\"javascript:auf('".$funktion[1]."','".$row->id."','');\"><img src=\"".$linksbild."\" border=\"0\">";        if($zusbild==1 AND $zusimage!="" AND $config->get('sem_p034',0)>0) {          $htxt .= "<div style=\"position:absolute;top:4px;left:4px;\"><img src=\"".$zusimage."\"></div>";        }        $htxt .= "</a></div>";        $html .= sem_f022($htxt,'d','l','',"sem_row");// Gebuehren anzeigen        $htxt = "";        if($row->fees>0) {          $gebuehr = sem_f044($row->fees);          $klasse = "sem_fees";          if($art==1 AND $buchopt[0]==2) {            if(count($buchopt[2])>0) {              if( $buchopt[2][0]->paid == 1) {                $klasse = "sem_fees_paid";              } else {                $klasse = "sem_fees_notpaid";              }              if($buchopt[2][0]->nrbooked>1) {                $gebuehr = sem_f044($row->fees*$buchopt[2][0]->nrbooked);                }            }          }          $htxt .= "<span class=\"".$klasse."\">".$config->get('sem_p017',JTEXT::_('SEM_0165'))." ".$gebuehr."</span>";                }// Beginn anzeigen        if($row->showbegin>0) {          if($row->cancelled == 1) {            $htxt .= "\n<span class=\"sem_cancelled\">".JTEXT::_('SEM_0103')."</span><span class=\"sem_date\"> (<del>".JHTML::_('date',$row->begin,$config->get('sem_p066',JTEXT::_('SEM_0166')),0)."</del>)</span><br />";          } else {            $htxt .= "\n<span class=\"sem_date\">".JHTML::_('date',$row->begin,$config->get('sem_p066',JTEXT::_('SEM_0166')),0)."</span><br />";          }        }// Titel anzeigen        $htxt .= "\n<a class=\"sem_title\" href=\"javascript:auf('".$funktion[1]."','".$row->id."','');\" title=\"".$funktion[0]."\">".$row->title."</a><br />";// Kurzbeschreibung anzeigen        $htxt .= "\n<span class=\"sem_shortdesc\">".$row->shortdesc."</span>";// Anmeldeschluss bzw. Buchungsdatum anzeigen        if($row->nrbooked<1) {          $htxt .= "<br />\n<span class=\"sem_cat\">".JTEXT::_('SEM_0133')."</span>";        } elseif($row->showbooked>0) {          if($buchopt[0] == 2) {            $htxt .= "<br />\n<span class=\"sem_cat\">".JTEXT::_('SEM_0032').": ".JHTML::_('date',$buchopt[2][0]->bookingdate,$config->get('sem_p066',JTEXT::_('SEM_0166')),0)."</span>";          } else {            if($row->cancelled==1) {              $htxt .= "<br />\n<span class=\"sem_cat\">".JTEXT::_('SEM_0011').": <del>".JHTML::_('date',$row->booked,$config->get('sem_p066',JTEXT::_('SEM_0166')),0)."</del></span>";            } else {              $htxt .= "<br />\n<span class=\"sem_cat\">".JTEXT::_('SEM_0011').": ".JHTML::_('date',$row->booked,$config->get('sem_p066',JTEXT::_('SEM_0166')),0)."</span>";            }          }        }        // Infozeile anzeigen        $gebucht = sem_f020($row);        if($config->get('sem_p014',0)==0) {          $htxt .= "<br />\n<span class=\"sem_cat\">".JTEXT::_('SEM_0008').": ".$row->category;          if($row->nrbooked>0) {            $htxt .= " - ".JTEXT::_('SEM_1044').": ".$gebucht->booked." - ".JTEXT::_('SEM_0053').": ".$buchopt[4]." - ".JTEXT::_('SEM_0058').": ".$row->hits;            $htxt .= "</span>";          }        }        $html .= sem_f022($htxt,'d','','98%',"sem_row");// Zertifikatdruck erlauben        if($config->get('sem_p003',0)>0 AND $art==1) {          if($buchopt[2][0]->certificated==1 AND $row->nrbooked>0) {            $htxt = sem_f037(1,$row->sid,'','');            $htbr = 30;          } else {            $htxt = "&nbsp;";            $htbr = "";          }          $html .= sem_f022($htxt,'h','',$htbr,"sem_row");        }// Anzeige der Teilnehmer erlauben        if(($config->get('sem_p030',0)==2 AND sem_f042()>1 AND $art==0) OR ($config->get('sem_p030',0)==1 AND $art==0) OR ($config->get('sem_p007',0)>0 AND sem_f042()>1 AND $art==1) OR ($config->get('sem_p031',0)>0 AND $art==2)) {          $htxt = "&nbsp";          if($row->nrbooked>0) {            $htxt = "<button class=\"button\" style=\"cursor:pointer;\" type=\"button\" onclick=\"auf(24,'".$row->id."','$art');\" title=\"".JTEXT::_('SEM_0035')."\">".$gebucht->booked."</button>";          }          $html .= sem_f022($htxt,'h','','30',"sem_row");        }// Bewertung erlauben        if($config->get('sem_p004',0)>0 AND $art>0) {          $htxt = "&nbsp";          if( $neudatum > $row->end AND $row->nrbooked>0) {            if($art==1) {              $htxt = sem_f035(sem_f006(),$row->id, $buchopt[2][0]->grade);            } elseif($art==2) {              $htxt = "<img src=\"".sem_f006()."240".$row->grade.".png\" alt=\"".JTEXT::_('SEM_0055')."\">";            }            $htbr = 30;          } else {            $htxt = "&nbsp;";            $htbr = "";          }          $html .= sem_f022($htxt,'h','',$htbr,"sem_row");        }// Ausgabe der Statusgrafik        if($config->get('sem_p025',2)>0) {          $htxt = "&nbsp;";          if($config->get('sem_p025',2)==1 AND $row->nrbooked>0) {            $htxt = "<img src=\"".sem_f006()."230".$buchopt[3].".png\" alt=\"".$buchopt[1]."\">";          } elseif ($config->get('sem_p025',2)==2 AND $row->nrbooked>0) {            $htxt = sem_f013($row->maxpupil,$buchopt[4],$buchopt[3]);          }          $html .= sem_f022($htxt,'d','c','24',"sem_row");        }         $html .= "</tr>";      }    } else {      $html .= "<tr>";      $html .= sem_f022(JTEXT::_('SEM_0062'),'h','','100%','sem_row');      $html .= "</tr>";    }    $html .= sem_f023('e');// ---------------------------------------// Ausgabe der Seitennavigation// ---------------------------------------    if(count($rows)<$total) {      $html .= $pageNav;    }// ---------------------------------------// Ausgabe der unsichtbaren Formularfelder// ---------------------------------------    if($art==0) {      $dots = array(JTEXT::_('SEM_0031'),JTEXT::_('SEM_0036'),JTEXT::_('SEM_0088'));    } elseif($art==1) {      $dots = array(JTEXT::_('SEM_0030'),JTEXT::_('SEM_0025'),JTEXT::_('SEM_0029'));    } elseif($art==2) {      $dots = array(JTEXT::_('SEM_0045'),JTEXT::_('SEM_0047'),JTEXT::_('SEM_0046'));    }// ---------------------------------------// Farbbeschreibungen anzeigen// ---------------------------------------    if(count($rows)>0 AND $config->get('sem_hide_ampel','')==0 AND $config->get('sem_p025',2)>0) {      $html .= sem_f029($dots[0],$dots[1],$dots[2]);    }// ---------------------------------// Anzeige Funktionsknoepfe unten// ---------------------------------    if($config->get('sem_p024',2)>0) {      $html .= sem_f023(4)."<tr>".sem_f022($knopfunten,'d','c','100%','sem_nav_d')."</tr>".sem_f023('e');    }// ---------------------------------------// Ausgabe der unsichtbaren Formularfelder// ---------------------------------------    foreach($navioben3 AS $el) {      switch($el) {        case "SEM_NUMBER":          $html .= "<input type=\"hidden\" name=\"limit\" value=\"".$limit."\">";          break;        case "SEM_SEARCH":          $html .= "<input type=\"hidden\" name=\"search\" value=\"".$search."\">";          break;        case "SEM_CATEGORIES":          $html .= "<input type=\"hidden\" name=\"catid\" value=\"".$catid."\">";          break;        case "SEM_TYPES":          $html .= "<input type=\"hidden\" name=\"dateid\" value=\"".$dateid."\">";          break;      }    }    $html .= sem_f014($art,"","","",$limitstart,0,"",-1);    echo $html;  }// ++++++++++++++++++++++++++++++++++++// +++ Anzeige der KursDetails      +++// ++++++++++++++++++++++++++++++++++++  function sem_g002($art,$row,$uid,$search,$catid,$limit,$limitstart,$dateid,$ueberschrift) {    global $mainframe;    $document = &JFactory::getDocument();    $database = &JFactory::getDBO();    $my = &JFactory::getuser();    $config = &JComponentHelper::getParams('com_seminar');    $neudatum = sem_f046();    JHTML::_('behavior.modal');    JHTML::_('behavior.tooltip');// ---------------------------------// Ist Kurs noch buchbar// ---------------------------------    $usrid = $my->id;    $modify = 26;    if($art>1) {      $usrid = $uid;    }    if($art>2) {      $modify = 29;    }    $buchopt = sem_f021($art,$row,$usrid);    $nametemp = "";    $htxt = 2;    if($art>2) {      if($usrid==0) {        $nametemp = sem_f011($row);      } else if($usrid>0) {        $nametemp = &JFactory::getuser($usrid);        $nametemp = $nametemp->name;      }      if($nametemp=="") {        $htxt = 2.2;      }    }    if($row->nrbooked==0) {      $htxt = 2.3;    }    $document->addCustomTag(sem_f027($htxt));    $bezahlt = 0;    if(count($buchopt[2])>0) {      if($buchopt[2][0]->paid==1) {        $bezahlt = 1;      }    }// ---------------------------------// Darf Kurs bearbeitet werden// ---------------------------------    $tempdis = " disabled";    if((($buchopt[0]==3 OR ($art==1 AND $config->get('sem_p022',"")==1 AND $bezahlt==0)) AND strtotime("$row->booked")-time()>=($config->get('sem_p018',0)*24*60*60) AND $art!=2) OR $art==3) {      $tempdis = "";    }// ---------------------------------// Anzeige Reiter // ---------------------------------    echo sem_f026(1);    $zurueck = array(0,1,0,23,23);    $knopfunten = "";    if($art==0 OR $art==2) {      $knopfunten = sem_f032(1);    } elseif($art==1) {      $knopfunten = sem_f032(2);    } elseif($art>2) {      $knopfunten = sem_f032(3);    }// ---------------------------------// Anzeige Funktionsknoepfe oben// ---------------------------------    $zusfeld = sem_f017($row);    $zfleer=1;    foreach($zusfeld[0] AS $el) {      if($el!="") {        $zfleer = 0;        break;      }    }    $gmapicon = "";// Zurueck-Knopf anzeigen    $knopfoben = "<a title=\"".JTEXT::_('SEM_1004')."\" href=\"javascript:auf('".$zurueck[$art]."','".$row->id."','');\"><img src=\"".sem_f006()."1032.png\" border=\"0\" align=\"absmiddle\"></a>";    $knopfunten .= " <button class=\"button\" style=\"cursor:pointer;\" type=\"button\" onclick=\"auf('".$zurueck[$art]."','".$row->id."','');\"><img src=\"".sem_f006()."1016.png\" border=\"0\" align=\"absmiddle\">&nbsp;".JTEXT::_('SEM_1004')."</button>";// Knopf fuer ICS-Datei anzeigen    if($config->get('sem_p052',0)>0) {      $knopfoben .= "<a title=\"".JTEXT::_('SEM_0130')."\" href=\"".sem_f004()."index2.php?s=".sem_f036()."&amp;option=".JRequest::getCmd('option')."&amp;task=33&amp;cid=".$row->id."\"><img src=\"".sem_f006()."3332.png\" border=\"0\" align=\"absmiddle\"></a>";      $knopfunten .= " <button onClick=\"document.location.href='".sem_f004()."index2.php?s=".sem_f036()."&amp;option=".JRequest::getCmd('option')."&amp;task=33&amp;cid=".$row->id."'\" class=\"button\" style=\"cursor:pointer;\" type=\"button\"><img src=\"".sem_f006()."3316.png\" border=\"0\" align=\"absmiddle\">&nbsp;".JTEXT::_('SEM_0130')."</button>";    }// Knopf fuer Nachricht anzeigen    if(($usrid!=$row->publisher) AND ($my->id!=$row->publisher) AND $art!=2) {      $knopfoben .= sem_f034(sem_f006(),$row->id,1);      $knopfunten .= " ".sem_f034(sem_f006(),$row->id,2);    }// Google-Maps-Karte anzeigen    if($config->get('sem_p012','') != "" AND $row->gmaploc != "" AND $art!=2) {      $knopfoben .= "<a title=\"".JTEXT::_('SEM_1016')."\" class=\"modal\" href=\"".sem_f005()."/seminar.gmap.php?key=".$config->get('sem_p012','')."&amp;ziel=".urlencode($row->gmaploc)."&amp;ort=".urlencode(str_replace("\n", "<br />", $row->place))."&amp;iw=".$config->get('sem_p013',1)."\" rel=\"{handler: 'iframe', size: {x: 500, y: 350}}\"><img src=\"".sem_f006()."1332.png\" border=\"0\" align=\"absmiddle\"></a>";      $knopfunten .= " <a class=\"modal\" border=\"0\" href=\"".sem_f005()."/seminar.gmap.php?key=".$config->get('sem_p012','')."&amp;ziel=".urlencode($row->gmaploc)."&amp;ort=".urlencode(str_replace("\n", "<br />", $row->place))."&amp;iw=".$config->get('sem_p013',1)."\" rel=\"{handler: 'iframe', size: {x: 500, y: 350}}\"><button class=\"button\" style=\"cursor:pointer;\" type=\"button\"><img src=\"".sem_f006()."1316.png\" border=\"0\" align=\"absmiddle\">&nbsp;".JTEXT::_('SEM_1016')."</button></a>";      $gmapicon = "<a title=\"".JTEXT::_('SEM_1016')."\" class=\"modal\" href=\"".sem_f005()."/seminar.gmap.php?key=".$config->get('sem_p012','')."&amp;ziel=".urlencode($row->gmaploc)."&amp;ort=".urlencode(str_replace("\n", "<br />", $row->place))."&amp;iw=".$config->get('sem_p013',1)."\" rel=\"{handler: 'iframe', size: {x: 500, y: 350}}\"><img src=\"".sem_f006()."1316.png\" width=\"12px\" height=\"12px\" style=\"vertical-align: middle;\" border=\"0\"/></a>";    }// Druckknopf anzeigen    if($art!=2 AND $art!=4) {          $knopfoben .= sem_f037(2,$row->id,'','');      $knopfunten .= " ".sem_f037(2,$row->id,'','b');    }    if((($buchopt[0]>2 AND $art==0) OR ($art==3 AND $usrid==0 AND ($nametemp!="" OR $config->get('sem_p026',0)==1))) AND $row->cancelled==0 AND $row->nrbooked>0) {      $knopfoben .= "<a title=\"".JTEXT::_('SEM_0087')."\" href=\"javascript:auf('5','".$row->id."','');\"><img src=\"".sem_f006()."1132.png\" border=\"0\" align=\"absmiddle\"></a>";      $knopfunten .= " <button class=\"button\" style=\"cursor:pointer;\" type=\"button\" onclick=\"auf('5','".$row->id."','');\"><img src=\"".sem_f006()."1116.png\" border=\"0\" align=\"absmiddle\">&nbsp;".JTEXT::_('SEM_0087')."</button>";    }// Aenderungen speichern Veranstalter     if($art==3 And $usrid!=0 AND ($row->nrbooked>1 OR $zfleer==0)) {      $knopfoben .= "<a title=\"".JTEXT::_('SEM_1045')."\" href=\"javascript:auf('".$modify."','".$row->id."','".$buchopt[2][0]->id."');\"><img src=\"".sem_f006()."1432.png\" border=\"0\" align=\"absmiddle\"></a>";      $knopfunten .= " <button class=\"button\" style=\"cursor:pointer;\" type=\"button\" onclick=\"auf('".$modify."','".$row->id."','".$buchopt[2][0]->id."');\"><img src=\"".sem_f006()."1416.png\" border=\"0\" align=\"absmiddle\">&nbsp;".JTEXT::_('SEM_1045')."</button>";    }// Aenderungen speichern Benutzer falls noch nicht gezahlt    if($art==1 AND strtotime("$row->booked")-time()>=($config->get('sem_p018',0)*24*60*60) AND $bezahlt==0) {      if($config->get('sem_p022',"")==1 AND ($row->nrbooked>1 OR $zfleer==0)) {        $knopfoben .= "<a title=\"".JTEXT::_('SEM_1045')."\" href=\"javascript:auf('".$modify."','".$row->id."','".$buchopt[2][0]->id."');\"><img src=\"".sem_f006()."1432.png\" border=\"0\" align=\"absmiddle\"></a>";        $knopfunten .= " <button class=\"button\" style=\"cursor:pointer;\" type=\"button\" onclick=\"auf('".$modify."','".$row->id."','".$buchopt[2][0]->id."');\"><img src=\"".sem_f006()."1416.png\" border=\"0\" align=\"absmiddle\">&nbsp;".JTEXT::_('SEM_1045')."</button>";      }// Buchung stornieren Benutzer falls noch nicht gezahlt      if($config->get('sem_p018',0)>-1) {        $knopfoben .= "<a title=\"".JTEXT::_('SEM_1012')."\" href=\"javascript:auf('6','".$buchopt[2][0]->id."','');\"><img src=\"".sem_f006()."1532.png\" border=\"0\" align=\"absmiddle\"></a>";        $knopfunten .= " <button class=\"button\" style=\"cursor:pointer;\" type=\"button\" onclick=\"auf('6','".$buchopt[2][0]->id."','');\"><img src=\"".sem_f006()."1516.png\" border=\"0\" align=\"absmiddle\">&nbsp;".JTEXT::_('SEM_1012')."</button>";      }    }// obere Knoepfe anzeigen    if($config->get('sem_p024',2)==0 OR $config->get('sem_p024',2)==2) {      echo $knopfoben;    }    sem_f033();// ---------------------// Anzeige Kurstitel// ---------------------    sem_f041($ueberschrift[0],$ueberschrift[1]);// ---------------------// Anzeige Kursangaben// ---------------------    if($row->nrbooked <= 1 OR $config->get('sem_p023','')<1) {      $platzauswahl = "";    } else {      $limits = array();      if($art==0 OR ($art==3 AND $usrid==0)) {        $tempplaetze = $buchopt[4];        $tempplatz = "";      } else {        $tempplatz = $buchopt[2][0]->nrbooked;        $tempplaetze = $buchopt[4] + $tempplatz;      }      if($tempplaetze>$row->nrbooked OR ($row->stopbooking==0 AND $art==0) OR ($art==3 AND $usrid==0)) {        $tempplaetze = $row->nrbooked;      }      for( $i=1; $i<=$tempplaetze; $i++) {        $limits[] = JHTML::_('select.option',$i);      }      $platzauswahl = JHTML::_('select.genericlist', $limits, 'nrbooked','class="sem_inputbox" size="1"'.$tempdis, 'value', 'text', $tempplatz);    }// Status fÃ¼r Parser festlegen    $parse = "sem_unregistered";    if($my->id>0) {      $parse = "sem_registered";    }    if($buchopt[0]==2) {      $parse = "sem_booked";      if($buchopt[2][0]->paid>0) {        $parse = "sem_paid";      }      if($buchopt[2][0]->certificated>0) {        $parse = "sem_certifcated";      }    }    $html = sem_f023(4);// Titel anzeigen    if($nametemp!="") {      $html .= "\n<tr>".sem_f022(JTEXT::_('SEM_0059').':','d','l','20%','sem_rowd').sem_f022($nametemp,'d','l','80%','sem_rowd')."</tr>";    }    $html .= "\n<tr>".sem_f022(JTEXT::_('SEM_0007').':','d','l','20%','sem_rowd').sem_f022($row->title,'d','l','80%','sem_rowd')."</tr>";// Veranstaltungsnummer anzeigen    if($row->semnum!="") {      $html .= "\n<tr>".sem_f022(JTEXT::_('SEM_0003').':','d','l','20%','sem_rowd').sem_f022($row->semnum,'d','l','80%','sem_rowd')."</tr>";    }// Status anzeigen    $htxt = $buchopt[1];    if($row->nrbooked<1) {      $htxt = JTEXT::_('SEM_0133');    }    $html .= "\n<tr>".sem_f022(JTEXT::_('SEM_0069').':','d','l','20%','sem_rowd').sem_f022($htxt,'d','l','80%','sem_rowd')."</tr>";// Buchungs-ID anzeigen    if(count($buchopt[2])>0) {      $html .= "\n<tr>".sem_f022(JTEXT::_('SEM_0097').':','d','l','20%','sem_rowd').sem_f022(sem_f002($buchopt[2][0]->id),'d','l','80%','sem_rowd')."</tr>";    }// Falls abgesagt Formatierung aendern    $htx1 = "";    $htx2 = "";    if($row->cancelled == 1) {      $htx1 = "\n<span class=\"sem_cancelled\">".JTEXT::_('SEM_0103')." </span>(<del>";      $htx2 = "</del>)";    }// Beginn anzeigen    if($row->showbegin>0) {      $html .= "\n<tr>".sem_f022(JTEXT::_('SEM_0009').':','d','l','20%','sem_rowd').sem_f022($htx1.JHTML::_('date',$row->begin,$config->get('sem_p067',JTEXT::_('SEM_0167')),0).$htx2,'d','l','80%','sem_rowd')."</tr>";    }// Ende anzeigen    if($row->showend>0) {      $html .= "\n<tr>".sem_f022(JTEXT::_('SEM_0010').':','d','l','20%','sem_rowd').sem_f022($htx1.JHTML::_('date',$row->end,$config->get('sem_p067',JTEXT::_('SEM_0167')),0).$htx2,'d','l','80%','sem_rowd')."</tr>";    }// Anmeldeschluss bzw. Buchungsdatum anzeigen    if($row->showbooked>0) {      if($art==0 OR ($art==3 AND $usrid==0)) {        $html .= "\n<tr>".sem_f022(JTEXT::_('SEM_0011').':','d','l','20%','sem_rowd').sem_f022($htx1.JHTML::_('date',$row->booked,$config->get('sem_p067',JTEXT::_('SEM_0167')),0).$htx2,'d','l','80%','sem_rowd')."</tr>";      } else {        $html .= "\n<tr>".sem_f022(JTEXT::_('SEM_0032').':','d','l','20%','sem_rowd').sem_f022(JHTML::_('date',$buchopt[2][0]->bookingdate,$config->get('sem_p067',JTEXT::_('SEM_0167')),0),'d','l','80%','sem_rowd')."</tr>";      }    }// Seminarleiter anzeigen    if($row->teacher!="") {      $html .= "\n<tr>".sem_f022(JTEXT::_('SEM_0019').':','d','l','20%','sem_rowd').sem_f022($row->teacher,'d','l','80%','sem_rowd')."</tr>";    }// Zielgruppe anzeigen    if($row->target!="") {      $html .= "\n<tr>".sem_f022(JTEXT::_('SEM_0012').':','d','l','20%','sem_rowd').sem_f022($row->target,'d','l','80%','sem_rowd')."</tr>";    }// Google-Map anzeigen    $html .= "\n<tr>".sem_f022(JTEXT::_('SEM_0015').': '.$gmapicon,'d','l','20%','sem_rowd').sem_f022(nl2br( $row->place ),'d','l','80%','sem_rowd')."</tr>";// Freie Plaetze anzeigen    if($row->nrbooked>0 AND $config->get('sem_p014',0)==0) {      $html .= "\n<tr>".sem_f022(JTEXT::_('SEM_0053').':','d','l','20%','sem_rowd').sem_f022($buchopt[4],'d','l','80%','sem_rowd')."</tr>";    }// Buchbare Plaetze als Auswahl anzeigen    $reqtext = "";    $reqfield = " <span class=\"sem_reqfield\">*</span>";    $reqnow = "\n<tr>".sem_f022("&nbsp;".$reqfield." ".JTEXT::_('SEM_0118'),'d','r','100%','sem_nav',2)."</tr>";    if($row->nrbooked>1 AND $config->get('sem_p023','')>0 AND ($buchopt[0]>1 OR $art==3)) {      if($buchopt[0]==3) {        $htx1 = JTEXT::_('SEM_1034');      } else {        $htx1 = JTEXT::_('SEM_1044');      }      if($tempdis=="") {        $htx2 = $platzauswahl;      } else {        $htx2 = "<input class=\"sem_inputbox\" type=\"text\" value=\"".$buchopt[2][0]->nrbooked."\"size=\"1\" style=\"text-align:right;\"".$tempdis." />";      }      $html .= "\n<tr>".sem_f022($htx1.':','d','l','20%','sem_rowd').sem_f022($htx2,'d','l','80%','sem_rowd')."</tr>";    }// Gebuehren anzeigen    if($row->fees>0) {      $html .= "\n<tr>".sem_f022(JTEXT::_('SEM_0022').':','d','l','20%','sem_rowd');      $htxt = $config->get('sem_p017',JTEXT::_('SEM_0165'))." ".sem_f044($row->fees);      if($config->get('sem_p023',0)>0) {        if($buchopt[0]!=2) {          $htxt .= " ".JTEXT::_('SEM_0085');        }        if($buchopt[0]==2 AND $buchopt[2][0]->nrbooked>1) {          $htxt = $config->get('sem_p017',JTEXT::_('SEM_0165'))." ".sem_f044($row->fees*$buchopt[2][0]->nrbooked)." (".$htxt." ".JTEXT::_('SEM_0085').")";          }      }      if($buchopt[0]==2) {        if( $buchopt[2][0]->paid==1) {          $htxt .= " - ".JTEXT::_('SEM_0102');        }      }      $html .= sem_f022($htxt,'d','l','80%','sem_rowd')."</tr>";    }// Dateien herunterladen  $datfeld = sem_f060($row);  $htxt = array();  for($i=0;$i<count($datfeld[0]);$i++) {    if($datfeld[0][$i]!="" AND ($datfeld[2][$i]==0 OR ($my->id>0 AND $datfeld[2][$i]==1) OR ($buchopt[0]==2 AND $datfeld[2][$i]==2) OR ($buchopt[2][0]->paid==1 AND $datfeld[2][$i]==3))) {      $htxt[] = "<tr><td style=\"white-space:nowrap;vertical-align:top;\"><span style=\"background-image:url(".sem_f006()."0002.png);background-repeat:no-repeat;background-position:2px;padding-left:18px;vertical-align:middle;\" ><a href=\"index.php?s=".sem_f036()."&amp;option=".JRequest::getCmd('option')."&amp;task=34&amp;a6d5dgdee4cu7eho8e7fc6ed4e76z=".sha1(md5($datfeld[0][$i])).$row->id."\">".$datfeld[0][$i]."</a></span></td><td width=\"80%\" style=\"vertical-align:top;\">".$datfeld[1][$i]."</td></tr>";    }  }  if(count($htxt)>0) {    $html .= "\n<tr>".sem_f022(JTEXT::_('SEM_0131').":",'d','l','20%','sem_rowd');    $htxt = sem_f023(4).implode($htxt).sem_f023('e');    $html .= sem_f022($htxt,'d','l','80%','sem_rowd')."</tr>";  }// Beschreibung anzeigen    if($row->description!="") {      $html .= "\n<tr>".sem_f022(sem_f065(sem_f063($row->description),$parse),'d','','','sem_rowd',2)."</tr>";    }    if($row->nrbooked>0) {// Name und E-Mail, falls Buchung fuer nichtregistrierte User erlaubt      $hidden = "";      if($config->get('sem_p026',0)>0 AND $usrid<1 AND (($buchopt[0]>2 AND $art==0) OR $art==3 OR $art==2) AND $row->cancelled==0) {        $zusname = "";        $zusemail = "";        if(count($buchopt[2])>0) {          $zusname = $buchopt[2][0]->name;          $zusemail = $buchopt[2][0]->email;        }          $htxt = "<input type=\"text\" class=\"sem_inputbox\" id=\"name\" name=\"name\" value=\"".$zusname."\" size=\"50\"".$tempdis.">".$reqfield;        $html .= "\n<tr>".sem_f022(JTEXT::_('SEM_0059').':','d','l','20%','sem_rowd').sem_f022($htxt,'d','l','80%','sem_rowd')."</tr>";        $htxt = "<input type=\"text\" class=\"sem_inputbox\" id=\"email\" name=\"email\" value=\"".$zusemail."\" size=\"50\"".$tempdis.">".$reqfield;        $html .= "\n<tr>".sem_f022(JTEXT::_('SEM_0052').':','d','l','20%','sem_rowd').sem_f022($htxt,'d','l','80%','sem_rowd')."</tr>";      } else {        $hidden .= "<input type=\"hidden\" name=\"name\" value=\"\"><input type=\"hidden\" name=\"email\" value=\"\">";      }// Zusatzfelder ausgeben      $zusreq = 0;      $zusfeld = sem_f017($row);      $zustemp = array('','','','','','','','','','','','','','','','','','','','');      if(count($buchopt[2])>0) {        $zustemp = sem_f017($buchopt[2][0]);        $zustemp = $zustemp[0];      }      for($i=0;$i<count($zusfeld[0]);$i++) {        if($zusfeld[0][$i]!="" AND ($buchopt[0]>1 OR $art==3)) {          $zusart = explode("|",$zusfeld[0][$i]);          if(count($buchopt[2])==0) {            $zustemp[$i] = $zusart[2];          }          $htxt = $zusart[0].sem_f055($zusfeld[1][$i]);          $temp = "";          $html .= "\n<tr>".sem_f022($htxt,'d','l','20%','sem_rowd');          if($tempdis=="") {            if($zusart[1]==1) {              $temp = $reqfield;              $reqtext = $reqnow;            }          }          if(count($zusart)>1) {            $optionen = array();            switch($zusart[3]) {              case "select":                $optionen[] = JHTML::_('select.option', '', '- '.JTEXT::_('SEM_1046').' -');                for($z=4;$z<count($zusart);$z++) {                  $optionen[] = JHTML::_('select.option', $zusart[$z], $zusart[$z]);                }                $htxt = JHTML::_('select.genericlist', $optionen, 'zusatz'.($i+1), 'class="sem_inputbox" size="1"'.$tempdis, 'value', 'text', $zustemp[$i]).$temp;                break;              case "radio":                for($z=4;$z<count($zusart);$z++) {                  $optionen[] = JHTML::_('select.option', $zusart[$z], $zusart[$z]);                }                $auswahl = $zustemp[$i];                if($zusfeld[2][$i]==1 AND $auswahl == "") {                  $auswahl = $zusart[2];                }                $htxt = JHTML::_('select.radiolist', $optionen, 'zusatz'.($i+1), 'class="sem_inputbox"'.$tempdis, 'value', 'text', $auswahl).$temp;                break;              case "textarea":                if(count($zusart)>4){                  if(!is_numeric($zusart[4])){                    $zusart[4]=30;                  }                  if(!is_numeric($zusart[5])){                    $zusart[5]=3;                  }                } else {                  $zusart[4]=30;                  $zusart[5]=3;                }                $htxt = "<textarea class=\"sem_inputbox\" id=\"zusatz".($i+1)."\" name=\"zusatz".($i+1)."\" cols=\"".$zusart[4]."\" rows=\"".$zusart[5]."\"".$tempdis.">".$zustemp[$i]."</textarea>".$temp;                break;              case "email":                $htxt = "<input type=\"text\" class=\"sem_inputbox\" id=\"emailzusatz".($i+1)."\" name=\"zusatz".($i+1)."\" value=\"".$zustemp[$i]."\" size=\"50\"".$tempdis.">".$temp;                break;              default:                $htxt = "<input type=\"text\" class=\"sem_inputbox\" id=\"zusatz".($i+1)."\" name=\"zusatz".($i+1)."\" value=\"".$zustemp[$i]."\" size=\"50\"".$tempdis.">".$temp;                break;            }          } else {            $htxt = "<input class=\"sem_inputbox\" type=\"text\" id=\"zusatz".($i+1)."\" name=\"zusatz".($i+1)."\" value=\"".$zustemp[$i]."\" size=\"50\"".$tempdis.">".$temp;          }          $html .= sem_f022($htxt,'d','l','80%','sem_rowd')."</tr>";          $zwang = 0;          if($zusart[1]==1) {            $zwang = 1;          }          $hidden .= "<input type=\"hidden\" id=\"opt".($i+1)."\" name=\"zusatz".($i+1)."opt\" value=\"".$zwang."\">";        } else {          $hidden .= "<input type=\"hidden\" id=\"zusatz".($i+1)."\" name=\"zusatz".($i+1)."\" value=\"\"><input type=\"hidden\" name=\"zusatz".($i+1)."opt\" value=\"0\">";        }      }// AGB-Bestaetigung anzeigen      if($config->get('sem_p020',"")!="" AND ($buchopt[0]>1 OR $art==3) AND $art!=2) {        $htx1 = "<input class=\"sem_inputbox\" type=\"checkbox\" name=\"veragb\" value=\"1\"";        if($buchopt[0]==2) {          $htx1 .= " checked=\"checked\"";          if($art==0 OR $art==2 OR $art==4 OR $tempdis!="") {            $htx1 .= " disabled";          }        }        $htx1 .= ">".$reqfield;        $htxt = JURI::ROOT()."index2.php?s=".sem_f036()."&option=".JRequest::getCmd('option')."&task=27";        $htxt = "<a href=\"".$htxt."\" class=\"modal\" rel=\"{handler: 'iframe', size: {x:500, y:350}}\">".JTEXT::_('SEM_1043')."</a>";        $htxt = str_replace("SEM_AGB",$htxt,JTEXT::_('SEM_1042'));        $html .= "\n<tr>".sem_f022($htx1,'d','r','20%','sem_rowd').sem_f022($htxt,'d','l','80%','sem_rowd')."</tr>";      } else {        $hidden .= "<input type=\"hidden\" name=\"veragb\" value=\"1\">";      }      $html .= $reqtext;      $html .= sem_f023('e');    }// ---------------------------------// Anzeige Funktionsknoepfe unten// ---------------------------------    if($config->get('sem_p024',2)>0) {      $html .= sem_f023(4)."<tr>".sem_f022($knopfunten,'d','c','100%','sem_nav_d')."</tr>".sem_f023('e');    }    $html .= $hidden;    // ---------------------------------------// Ausgabe der unsichtbaren Formularfelder// ---------------------------------------    if($row->nrbooked <= 1 OR $config->get('sem_p023','') < 1) {      $html .= "<input type=\"hidden\" name=\"nrbooked\" value=\"1\">";    }    $uidtemp = -1;    if($art==3){      if($usrid==0) {        $uidtemp = "";      } else {        $uidtemp = $usrid;      }    }    $html .= sem_f014(3,$catid,$search,$limit,$limitstart,$row->id,$dateid,$uidtemp);    echo $html;  }// ++++++++++++++++++++++++++++++++++++// +++ Seminar bearbeiten +++// ++++++++++++++++++++++++++++++++++++  function sem_g006($row,$search,$catid,$limit,$limitstart,$dateid) {    JFilterOutput::objectHTMLSafe($row);    $config = &JComponentHelper::getParams('com_seminar');    $document = &JFactory::getDocument();    $document->addCustomTag(sem_f027(3 + $config->get('sem_p032',0)));    JHTML::_('behavior.modal');    JHTML::_('behavior.calendar');    JHTML::_('behavior.tooltip');// ---------------------------------// Anzeige Kopfbereich mit Auswahl// ---------------------------------    echo sem_f026(3);    $knopfunten = sem_f032(3);    $knopfoben = "<a title=\"".JTEXT::_('SEM_1004')."\" href=\"javascript:auf(2,'','');\"><img src=\"".sem_f006()."1032.png\" border=\"0\" align=\"absmiddle\"></a>";    $knopfunten .= " <button class=\"button\" style=\"cursor:pointer;\" type=\"button\" onclick=\"auf(2,'','');\"><img src=\"".sem_f006()."1016.png\" border=\"0\" align=\"absmiddle\">&nbsp;".JTEXT::_('SEM_1004')."</button>";    $knopfoben .= "<a title=\"".JTEXT::_('SEM_1037')."\" href=\"javascript:auf(10,'".$row->id."','');\"><img src=\"".sem_f006()."1432.png\" border=\"0\" align=\"absmiddle\"></a>";    $knopfunten .= " <button class=\"button\" style=\"cursor:pointer;\" type=\"button\" onclick=\"auf(10,'".$row->id."','');\"><img src=\"".sem_f006()."1416.png\" border=\"0\" align=\"absmiddle\">&nbsp;".JTEXT::_('SEM_1037')."</button>";    if($row->id>0) {      $knopfoben .= "<a title=\"".JTEXT::_('SEM_0044')."\" href=\"javascript:auf(12,'".$row->id."','');\"><img src=\"".sem_f006()."1232.png\" border=\"0\" align=\"absmiddle\"></a>";      $knopfunten .= " <button class=\"button\" style=\"cursor:pointer;\" type=\"button\" onclick=\"auf(12,'".$row->id."','');\"><img src=\"".sem_f006()."1216.png\" border=\"0\" align=\"absmiddle\">&nbsp;".JTEXT::_('SEM_0044')."</button>";      $knopfoben .= "<a title=\"".JTEXT::_('SEM_1014')."\" href=\"javascript:auf(11,'".$row->id."','');\"><img src=\"".sem_f006()."1532.png\" border=\"0\" align=\"absmiddle\"></a>";      $knopfunten .= " <button class=\"button\" style=\"cursor:pointer;\" type=\"button\" onclick=\"auf(11,'".$row->id."','');\"><img src=\"".sem_f006()."1516.png\" border=\"0\" align=\"absmiddle\">&nbsp;".JTEXT::_('SEM_1014')."</button>";    }    if($config->get('sem_p024',2)==0 OR $config->get('sem_p024',2)==2) {      echo $knopfoben;    }    sem_f033();// ---------------------------------// Anzeige Bereichsueberschrift// ---------------------------------    if($row->id == "") {      $temp1 = JTEXT::_('SEM_0060');      $temp2 = JTEXT::_('SEM_1029');    } else {      $temp1 = JTEXT::_('SEM_0051');      $temp2 = JTEXT::_('SEM_1015');    }    sem_f041("$temp1","$temp2");// ---------------------------------// Anzeige Eingabefelder// ---------------------------------    $html = sem_f023(4).sem_f008($row,1).sem_f023('e');// ---------------------------------// Anzeige Funktionsknoepfe unten// ---------------------------------    if($config->get('sem_p024',2)>0) {      $html .= sem_f023(4)."<tr>".sem_f022($knopfunten,'d','c','100%','sem_nav_d')."</tr>".sem_f023('e');    }// ---------------------------------------// Ausgabe der unsichtbaren Formularfelder// ---------------------------------------    if($row->published == "") {      $html .= "\n<input type=\"hidden\" name=\"published\" value=\"1\" />";    } else {      $html .= "\n<input type=\"hidden\" name=\"published\" value=\"".$row->published."\" />";    }    if(sem_f042()<6) {      $html .= "<input type=\"hidden\" name=\"publisher\" value=\"".$row->publisher."\" />";    }    $html .= "<input type=\"hidden\" name=\"id\" value=\"".$row->id."\" />";    $html .= sem_f014("",$catid,$search,$limit,$limitstart,0,$dateid,-1);    echo $html;  }  // ++++++++++++++++++++++++++++++++++++// +++ Buchungen ansehen            +++// ++++++++++++++++++++++++++++++++++++//  listen = catid, dateid, blist  function sem_g010($art,$rows,$search,$limit,$limitstart,$kurs,$catid,$dateid) {    $document = &JFactory::getDocument();    $document->addCustomTag(sem_f027(0));    $config = &JComponentHelper::getParams('com_seminar');    $my = &JFactory::getuser();    JHTML::_('behavior.modal');    JHTML::_('behavior.tooltip');// ---------------------------------// Anzeige Kopfbereich mit Auswahl// ---------------------------------    $buchopt = sem_f021(0,$kurs,0);    echo sem_f026(1);    $knopfunten = sem_f032(($art+1));    $zurueck = array(0,1,2,24);    $knopfoben = "<a title=\"".JTEXT::_('SEM_1004')."\" href=\"javascript:auf(".$zurueck[$art].",'','');\"><img src=\"".sem_f006()."1032.png\" border=\"0\" align=\"absmiddle\"></a>";    $knopfunten .= "<button class=\"button\" style=\"cursor:pointer;\" type=\"button\" onclick=\"auf('".$zurueck[$art]."','','');\"><img src=\"".sem_f006()."1016.png\" border=\"0\" align=\"absmiddle\">&nbsp;".JTEXT::_('SEM_1004')."</button>";    if($art>1) {      $knopfoben .= sem_f034(sem_f006(),$kurs->id,3);      $knopfunten .= " ".sem_f034(sem_f006(),$kurs->id,4);    }    if( count($rows)>0 AND $art>1) {      $knopfoben .= sem_f037(7,$kurs->id,'','');      $knopfoben .= sem_f037(5,$kurs->id,'','');      $knopfoben .= "<a title=\"".JTEXT::_('SEM_0049')."\" href=\"javascript:auf(25,'".$kurs->id."','');\"><img src=\"".sem_f006()."1632.png\" border=\"0\" align=\"absmiddle\"></a>";      $knopfunten .= " ".sem_f037(7,$kurs->id,'','b');      $knopfunten .= " ".sem_f037(5,$kurs->id,'','b');      $knopfunten .= " <button class=\"button\" style=\"cursor:pointer;\" type=\"button\" onclick=\"auf(25,'".$kurs->id."','');\"><img src=\"".sem_f006()."1616.png\" border=\"0\" align=\"absmiddle\">&nbsp;".JTEXT::_('SEM_0049')."</button>";    }    if($art>1) {      $knopfoben .= "<a title=\"".JTEXT::_('SEM_0087')."\" href=\"javascript:auf('28','".$kurs->id."','');\"><img src=\"".sem_f006()."1132.png\" border=\"0\" align=\"absmiddle\"></a>";      $knopfunten .= " <button class=\"button\" style=\"cursor:pointer;\" type=\"button\" onclick=\"auf('28','".$kurs->id."','');\"><img src=\"".sem_f006()."1116.png\" border=\"0\" align=\"absmiddle\">&nbsp;".JTEXT::_('SEM_0087')."</button>";    }    if($config->get('sem_p024',2)==0 OR $config->get('sem_p024',2)==2) {      echo $knopfoben;    }    sem_f033();// ---------------------------------// Anzeige Bereichsueberschrift// ---------------------------------    $htxt = $kurs->title;    if($kurs->cancelled==1) {      $htxt .= " (<span class=\"sem_cancelled\">".JTEXT::_('SEM_0103')."</span>)";    }    $temp1 = str_replace('SEM_TITLE',$htxt,JTEXT::_('SEM_1040'));    sem_f041(JTEXT::_('SEM_1041'),$temp1);// ---------------------------------// Anzeige der Spaltenueberschriften// ---------------------------------    $html = sem_f023(4)."<tr>";    if($art==2) {      $html .= sem_f022('&nbsp;','h','c',14,'sem_row');    }    $html .= sem_f022(JTEXT::_('SEM_0059'),'h','l','','sem_row');    if($art==2) {      $html .= sem_f022(JTEXT::_('SEM_0052'),'h','l','','sem_row');      $html .= sem_f022(JTEXT::_('SEM_0032'),'h','c','','sem_row');    }    $zusfeld = sem_f017($kurs);    for($i=0;$i<count($zusfeld[0]);$i++) {      if($zusfeld[2][$i]==1) {        $zustmp = explode("|",$zusfeld[0][$i]);        $html .= sem_f022($zustmp[0],'h','l','','sem_row');      }    }    $html .= sem_f022(JTEXT::_('SEM_0033'),'h','c','','sem_row');    if($art==2) {      if( $kurs->fees > 0) {        $html .= sem_f022(JTEXT::_('SEM_0065'),'h','c','','sem_row');      }              if($config->get('sem_p003',0)>0) {        $html .= sem_f022(JTEXT::_('SEM_0040'),'h','c','','sem_row');      }      if($config->get('sem_p004',0)>0) {        $html .= sem_f022(JTEXT::_('SEM_0055'),'h','c','','sem_row');      }    }    $html .= sem_f022(JTEXT::_('SEM_0069'),'h','c',12,'sem_row');    $html .= "</tr>";// ---------------------------------// Anzeige der einzelnen Buchungen// ---------------------------------    $n = count($rows);    if( $n > 0 ) {      $neudatum = sem_f046();      $anzahl = 0;      foreach ($rows as $row) {        if($config->get('sem_p058',0)==0 AND $art<2) {          $row->name = $row->username;        }        if($row->userid==0) {          $row->name = $row->aname;          $row->email = $row->aemail;        }        $anzahl = $anzahl + $row->nrbooked;        $bild = "2502.png";        $altbild = JTEXT::_('SEM_0030');        if( $anzahl > $kurs->maxpupil ) {          if( $kurs->stopbooking < 1 ) {            $bild = "2501.png";            $altbild = JTEXT::_('SEM_0025');          } else {            $bild = "2500.png";            $altbild = JTEXT::_('SEM_0029');          }        }        if($kurs->cancelled==1) {          $bild = "2500.png";          $altbild = JTEXT::_('SEM_0029');        }        $certtitel = JTEXT::_('SEM_0091');        if($row->certificated == 1) {          $certtitel = JTEXT::_('SEM_0090');        }        $paidtitel = JTEXT::_('SEM_0064');        if($row->paid == 1) {          $paidtitel = JTEXT::_('SEM_0063');        }        $html .= "\n<tr>";        if($art==2) {          $htxt = "<a title=\"".JTEXT::_('SEM_1012')."\" href=\"javascript:auf(7,'".$row->sid."','');\"><img src=\"".sem_f006()."2202.png\" border=\"0\"></a>";          $html .= sem_f022($htxt,'d','c',14,"sem_row");        }        $htxt = $row->name;        if($art==2) {          $htxt = "<a href=\"javascript:auf('28','".$kurs->id."','".$row->sid."');\">".$row->name."</a>";        }        $html .= sem_f022($htxt,'d','l','',"sem_row");        if($art==2) {          $html .= sem_f022("<a href=\"mailto:".$row->email."\">".$row->email."</a>",'d','l','',"sem_row");          $html .= sem_f022(JHTML::_('date',$row->bookingdate,$config->get('sem_p068',JTEXT::_('SEM_0168')),0),'d','c','',"sem_row");        }        $zustemp = sem_f017($row);        for($i=0;$i<count($zusfeld[0]);$i++) {          if($zusfeld[2][$i]==1) {            $html .= sem_f022($zustemp[0][$i],'d','l','','sem_row');          }        }        $html .= sem_f022($row->nrbooked,'d','c','',"sem_row");        if($art==2) {          if($kurs->fees>0) {            $htxt = "&nbsp;";            if($anzahl <= $kurs->maxpupil) {              $htxt = "<a title=\"".$paidtitel."\" href=\"javascript:auf(14,'".$row->sid."','');\"><img src=\"".sem_f006()."220".$row->paid.".png\" border=\"0\" align=\"absmiddle\"></a>";            }            $html .= sem_f022($htxt,'d','c','',"sem_row");          }          if($config->get('sem_p003',0)>0) {            $htxt = "&nbsp;";            if($anzahl <= $kurs->maxpupil) {              $htxt = "<a title=\"".$certtitel."\" href=\"javascript:auf(13,'".$row->sid."','');\"><img src=\"".sem_f006()."220".$row->certificated.".png\" border=\"0\" align=\"absmiddle\"></a>";              if($row->certificated == 1) {                $htxt .= " ".sem_f037(1,$row->sid,'','');              }            }            $html .= sem_f022($htxt,'d','c','',"sem_row");          }          if($config->get('sem_p004',0)>0) {            $hinttext = JTEXT::_('SEM_0055')."::".htmlspecialchars($row->comment);            $htxt = "<img src=\"".sem_f006()."240".$row->grade.".png\" class=\"editlinktip hasTip\" title=\"".$hinttext."\">";            $html .= sem_f022($htxt,'d','c','',"sem_row");          }        }        $html .= sem_f022("<img src=\"".sem_f006().$bild."\" border=\"0\" alt=\"".$altbild."\">",'d','c','',"sem_row");        $html .= "\n</tr>";      }    } else {      $spalten = 3;      if($art==2) {        $spalten = 9;      }      $html .= "\n<tr>".sem_f022(JTEXT::_('SEM_0061'),'d','l','','sem_row',$spalten)."</tr>";    }    $html .= sem_f023('e');// ---------------------------------------// Ausgabe der unsichtbaren Formularfelder// ---------------------------------------    if($kurs->nrbooked <= 1 || $config->get('sem_p023','') < 1) {      $html .= "<input type=\"hidden\" name=\"nrbooked\" value=\"1\">";          }    $html .= sem_f014($zurueck[$art],$catid,$search,$limit,$limitstart,0,$dateid,-1);// ---------------------------------------// Farbbeschreibungen anzeigen// ---------------------------------------    $html .= sem_f029(JTEXT::_('SEM_0030'),JTEXT::_('SEM_0025'),JTEXT::_('SEM_0029'));// ---------------------------------// Anzeige Funktionsknoepfe unten// ---------------------------------    if($config->get('sem_p024',2)>0) {      $html .= sem_f023(4)."<tr>".sem_f022($knopfunten,'d','c','100%','sem_nav_d')."</tr>".sem_f023('e');    }    echo $html;  }// +++++++++++++++++++++++++++++++++++++++++++++++// +++ Bewertungsfenster ausgeben        +++// +++++++++++++++++++++++++++++++++++++++++++++++  function sem_g014($row,$buchung) {    $htxt = str_replace("SEM_TITLE",$row->title,JTEXT::_('SEM_1017'));    $html = "\n<body onload=\"parent.sbox-window.focus();\">";    $html .= sem_f026(1)."<div class=\"sem_cat_title\">".JTEXT::_('SEM_1020')."</div><br />";    $html .= "<div class=\"sem_shortdesc\">".$htxt."</div>";    $html .= "<br /><center><table cellpadding=\"2\" cellspacing=\"0\" border=\"0\">";    $tempa = "";    $tempb = "";    for ($i=6; $i>0; $i=$i-1) {      $tempa .= "<th><img src=\"".sem_f006()."240".$i.".png\"></th><td width=\"10px\">&nbsp;</td>";      $tempb .= "<th><input type=\"radio\" name=\"grade\" value=\"".$i."\"";      if( $i==$buchung->grade) {        $tempb .= " checked";      }      $tempb .= "></th><td width=\"10px\">&nbsp;</td>";    }    $html .= "<tr>".$tempa."</tr>";    $html .= "<tr>".$tempb."</tr>";    $html .= "</table></center>";    $html .= "<br /><div class=\"sem_shortdesc\">".JTEXT::_('SEM_0042').":</div>";    $html .= "<br /><center><input type=\"text\" name=\"text\" size=\"70\" maxlength=\"200\" value=\"".$buchung->comment."\"></center><br />";    $html .= "<input type=\"hidden\" name=\"option\" value=\"".JRequest::getCmd('option')."\"><input type=\"hidden\" name=\"cid\" value=\"".$row->id."\"><input type=\"hidden\" name=\"task\" value=\"21\">";    $html .= "<center><button class=\"button\" style=\"cursor:pointer;\" type=\"button\" onclick=\"this.disabled=true;document.FrontForm.submit();\">".JTEXT::_('SEM_1038')."</button></center>";    $html .= "</form>";    $html .= "</body></html>";    echo $html;    exit;  }// +++++++++++++++++++++++++++++++++++++++++++++++// +++ Bewertung abgegeben                     +++// +++++++++++++++++++++++++++++++++++++++++++++++  function sem_g021($grade,$cid) {    $html = "\n<body onload=\"parent.sbox-window.focus();\">";    $html .= "<script language=\"javascript\">window.parent.document.getElementById('graduate".$cid."').src='".sem_f006()."240".$grade.".png';window.parent.document.getElementById('sbox-window').close();</script>";    echo $html;    exit;  }// +++++++++++++++++++++++++++++++++++++++++++++++// +++ Nachricht an Veranstalter senden        +++// +++++++++++++++++++++++++++++++++++++++++++++++  function sem_g016($art,$row) {    if($art==1) {      $htxt = str_replace("SEM_TITLE",$row->title,JTEXT::_('SEM_1021'));    } else {      $htxt = str_replace("SEM_TITLE",$row->title,JTEXT::_('SEM_1047'));    }    $html = "\n<body onload=\"parent.sbox-window.focus();\">";    $html .= sem_f026(1)."<div class=\"sem_cat_title\">".JTEXT::_('SEM_1028')."</div><br />";    $html .= "<div id=\"loader\" style=\"position: absolute; top:113; left:188; width:124px; height:124px; z-Index:10001; display: none;\"><img src=\"".sem_f006()."loader.gif\" width=\"124px\" height=\"124px\" style=\"width:124px; height:124px;\"></div>";    $html .= "<div class=\"sem_shortdesc\">".$htxt."</div><br />";    $html .= "<center><textarea name=\"text\" rows=\"10\" cols=\"50\"></textarea></center>";    $html .= "<input type=\"hidden\" name=\"option\" value=\"".JRequest::getCmd('option')."\"><input type=\"hidden\" name=\"cid\" value=\"".$row->id."\"><input type=\"hidden\" name=\"uid\" value=\"".$art."\"><input type=\"hidden\" name=\"task\" value=\"22\">";    $html .= "<br /><center><button class=\"button\" style=\"cursor:pointer;\" type=\"button\" onclick=\"this.disabled=true;document.FrontForm.submit();\">".JTEXT::_('SEM_1038')."</button></center>";    $html .= "</form>";    $html .= "</body></html>";    echo $html;    exit;  }// +++++++++++++++++++++++++++++++++++++++++++++++// +++ AGB anzeigen                            +++// +++++++++++++++++++++++++++++++++++++++++++++++  function sem_g020() {    $config = &JComponentHelper::getParams('com_seminar');    $html = "\n<body onload=\"parent.sbox-window.focus();\">";    $html .= nl2br($config->get('sem_p020',""));    $html .= "</body></html>";    echo $html;    exit;  }// +++++++++++++++++++++++++++++++++++++++++++++++// +++ Nachricht an Veranstalter verschickt    +++// +++++++++++++++++++++++++++++++++++++++++++++++  function sem_g022($reason) {    $html = "\n<body onload=\"parent.sbox-window.focus();\">";    $html .= "<center><table width=\"80%\" height=\"100%\" border=\"0\"><tr><td align=\"center\"><div class=\"sem_title\">".$reason."</div>";    $html .= "</td></tr></table></center>";    $html .= "</body></html>";    echo $html;    exit;  }// +++++++++++++++++++++++++++++// +++ RSS-Feed erzeugen     +++// +++++++++++++++++++++++++++++  function sem_g023($rows) {    header("Content-Type: application/rss+xml; charset=UTF-8");    $mainconfig =& JFactory::getConfig();    $config = &JComponentHelper::getParams('com_seminar');    $sprache =& JFactory::getLanguage();    $html = "\n<rss version=\"2.0\">";    $html .= "\n<channel>";    $html .= "\n<title>".$mainconfig->getValue('config.sitename')." - ".JTEXT::_('SEM_0083')."</title>";    $html .= "\n<link>".JURI::ROOT()."index2.php?s=".sem_f036()."&amp;option=".JRequest::getCmd('option')."&amp;task=31</link>";    $html .= "\n<description>Kurze Beschreibung des Feeds</description>";    $html .= "\n<language>".$sprache->getTag()."</language>";    $html .= "\n<copyright>".$mainconfig->getValue('config.fromname')."</copyright>";    $html .= "\n<ttl>60</ttl>";    $html .= "\n<pubDate>".date("r")."</pubDate>";        foreach($rows AS $row) {      $user = &JFactory::getuser($row->publisher);      $cancelled = "";      if($row->cancelled==1) {        $cancelled = " - ".JTEXT::_('SEM_0103');      }      $html .= "\n<item>";      $html .= "\n<title>".$row->title.$cancelled."</title>";      $html .= "\n<description>".JTEXT::_('SEM_0009').": ".JHTML::_('date',$row->begin,$config->get('sem_p067',JTEXT::_('SEM_0167')),0)." - ".$row->shortdesc."</description>";      $html .= "\n<link>".JURI::ROOT()."index.php?option=".JRequest::getCmd('option')."&amp;task=3&amp;cid=".$row->id."</link>";      if($config->get('sem_p050',0)>0) {        $html .= "\n<author>".$user->name.", ".$user->email."</author>";      }      $html .= "\n<guid>".sem_f002($row->id)."</guid>";      $html .= "\n<category>".$row->category."</category>";      $html .= "\n<pubDate>".date("r",strtotime($row->publishdate))."</pubDate>";      $html .= "\n</item>";    }    $html .= "\n</channel>";    $html .= "\n</rss>";    echo $html;    exit;  }}?>